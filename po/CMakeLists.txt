if(WIN32)
 set(CMAKE_PROGRAM_PATH "${CMAKE_SOURCE_DIR}/utils/win32" ${CMAKE_PROGRAM_PATH})
endif(WIN32)

include(FindGettext)

if(GETTEXT_FOUND)
 #find_program(GETTEXT_XGETTEXT_EXECUTABLE xgettext)
 set(poTplFile "${CMAKE_CURRENT_SOURCE_DIR}/${UNIX_PROG_NAME}.pot")
 #file(WRITE "${poTplFile}" "")
 #file(GLOB poExtrSources ${CMAKE_SOURCE_DIR}/src/*.cpp)
 #foreach(poExtrSource ${poExtrSources})
 # execute_process(COMMAND ${GETTEXT_XGETTEXT_EXECUTABLE} --boost -ktranslate -s -j -o "${poTplFile}" "${poExtrSource}")
 #endforeach(poExtrSource)
 add_custom_target(translations ALL DEPENDS)
 file(GLOB poLangDirs *)
 foreach(poLangDir ${poLangDirs})
  get_filename_component(poLang "${poLangDir}" NAME)
  if (EXISTS "${poLangDir}/${poLang}.po")
   execute_process(COMMAND ${GETTEXT_MSGMERGE_EXECUTABLE} --backup=none -s -U "${poLangDir}/${poLang}.po" "${poTplFile}")
   file(MAKE_DIRECTORY "${CMAKE_CURRENT_BINARY_DIR}/${poLang}/LC_MESSAGES")
   add_custom_command(TARGET translations COMMAND ${GETTEXT_MSGFMT_EXECUTABLE} -c -o \"${CMAKE_CURRENT_BINARY_DIR}/${poLang}/LC_MESSAGES/${UNIX_PROG_NAME}.mo\" \"${poLangDir}/${poLang}.po\")
  endif(EXISTS "${poLangDir}/${poLang}.po")
 endforeach(poLangDir)
 #file(REMOVE "${poTplFile}")
endif(GETTEXT_FOUND)
